pico-8 cartridge // http://www.pico-8.com
version 29
__lua__

#include lib/math.lua
#include lib/particles.lua
#include lib/physics.lua
#include lib/perlin.lua
#include lib/entities.lua

#include player.lua


e = emitter.new()
--e.settings.rate.val = 0.08
e.settings.rate.val = 0.2
e.settings.angle.dev = 70
e.settings.life.val = 40.0
e.settings.life.dev = 2.0
e.settings.distance.start.val = 3
e.settings.distance.start.dev = 3
e.settings.distance.stop.val = 40
e.settings.distance.stop.dev = 5
e.settings.size.start.val = 1.5
e.settings.size.start.dev = 0.5
e.settings.size.stop.val = 0.5
e.settings.size.stop.dev = 0.5
e.settings.easing = easing.quad_out
e.settings.color = {7,10,9,8,2}

c2 = collider.new(100, 70, -30, -10, 5, 5, 0b10)
c3 = collider.new(100, 70, -10, -70, 20, 20, 0b10)

function _init()
  local _a = vec2.new(1.5, 1)
  local _b = vec2.new()
  print(vec2.add(_a, _b))
  print(_a:sub(_b))
  print(_a:dot(_b))

  entity_manager.add(player)

  physics.register(c2)
  physics.register(c3)
end

time = 0
function _update()
  cls()

  entity_manager.update()

  local _t = (time % 60.0) / 60.0
  e.active = _t > 0.5
  local _dir = vec2.new(cos(_t), sin(_t))
  local _pos = vec2.new(64,64):add(_dir:mul(30))
  e.settings.angle.val = _t * P2D - 90.0
  e:update(_pos.x, _pos.y)
  time = time + 1
end

function _draw()
  entity_manager.draw()

  e:draw()

  --physics.draw(0b01, 8)
  physics.draw(0b10, 12)
  color()
  --print(#e._particles)
  --print(stat(7).."FPS")
end

__gfx__
00000000000110000001100000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000220000002200000022000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700001011000010110000101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000111000011110000111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000550000005500000055000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000110000001100000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000110000001100000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000010000001100000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0001000004310043200431004300210002100023000230002100021000260002000020000260001300013000130001700017000190001b0001c0001500016000160001b0001b000220001b000130000d00018000
